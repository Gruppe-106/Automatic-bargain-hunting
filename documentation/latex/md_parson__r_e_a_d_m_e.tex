Parson is a lightweight \href{http://json.org}{\texttt{ json}} library written in C.\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md1}{}\doxysection{Features}\label{md_parson__r_e_a_d_m_e_autotoc_md1}

\begin{DoxyItemize}
\item Lightweight (only 2 files)
\item Simple API
\item Addressing json values with dot notation (similar to C structs or objects in most OO languages, e.\+g. \char`\"{}object\+A.\+object\+B.\+value\char`\"{})
\item C89 compatible
\item Test suites
\end{DoxyItemize}\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md2}{}\doxysection{Installation}\label{md_parson__r_e_a_d_m_e_autotoc_md2}
Run\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{git clone https://github.com/kgabis/parson.git}

\end{DoxyCode}
 and copy \mbox{\hyperlink{parson_8h}{parson.\+h}} and \mbox{\hyperlink{parson_8c}{parson.\+c}} to you source code tree.

Run {\ttfamily make test} to compile and run tests.\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md3}{}\doxysection{Examples}\label{md_parson__r_e_a_d_m_e_autotoc_md3}
\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md4}{}\doxysubsection{Parsing JSON}\label{md_parson__r_e_a_d_m_e_autotoc_md4}
Here is a function, which prints basic commit info (date, sha and author) from a github repository. ~\newline
 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_a2e53a072e95e141351fa4c8238236c64}{print\_commits\_info}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *username, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *repo) \{}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__value__t}{JSON\_Value}} *root\_value;}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__array__t}{JSON\_Array}} *commits;}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__object__t}{JSON\_Object}} *commit;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} i;}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{keywordtype}{char} curl\_command[512];}
\DoxyCodeLine{    \textcolor{keywordtype}{char} cleanup\_command[256];}
\DoxyCodeLine{    \textcolor{keywordtype}{char} output\_filename[] = \textcolor{stringliteral}{"{}commits.json"{}};}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{comment}{/* it ain't pretty, but it's not a libcurl tutorial */}}
\DoxyCodeLine{    sprintf(curl\_command, }
\DoxyCodeLine{        \textcolor{stringliteral}{"{}curl -\/s \(\backslash\)"{}https://api.github.com/repos/\%s/\%s/commits\(\backslash\)"{} > \%s"{}},}
\DoxyCodeLine{        username, repo, output\_filename);}
\DoxyCodeLine{    sprintf(cleanup\_command, \textcolor{stringliteral}{"{}rm -\/f \%s"{}}, output\_filename);}
\DoxyCodeLine{    system(curl\_command);}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{comment}{/* parsing json and validating output */}}
\DoxyCodeLine{    root\_value = \mbox{\hyperlink{parson_8c_ab46574724afc3f8bb047b73a9d477179}{json\_parse\_file}}(output\_filename);}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\mbox{\hyperlink{parson_8c_ac9afd8b1fc34493d5dfddd84540818eb}{json\_value\_get\_type}}(root\_value) != \mbox{\hyperlink{parson_8h_a1ee1fe8e5c3c800acbda6467e12c8850a9e2a41c9b40c722fb4e6106289a2e870}{JSONArray}}) \{}
\DoxyCodeLine{        system(cleanup\_command);}
\DoxyCodeLine{        \textcolor{keywordflow}{return};}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{comment}{/* getting array from root value and printing commit info */}}
\DoxyCodeLine{    commits = \mbox{\hyperlink{parson_8c_a3576591e51f5e56527218979b21fd659}{json\_value\_get\_array}}(root\_value);}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}\%-\/10.10s \%-\/10.10s \%s\(\backslash\)n"{}}, \textcolor{stringliteral}{"{}Date"{}}, \textcolor{stringliteral}{"{}SHA"{}}, \textcolor{stringliteral}{"{}Author"{}});}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{parson_8c_a3cdef5191eb478cae45757377e3e48f5}{json\_array\_get\_count}}(commits); i++) \{}
\DoxyCodeLine{        commit = \mbox{\hyperlink{parson_8c_a702d7e9cc3aa91a031f50b52030d0558}{json\_array\_get\_object}}(commits, i);}
\DoxyCodeLine{        printf(\textcolor{stringliteral}{"{}\%.10s \%.10s \%s\(\backslash\)n"{}},}
\DoxyCodeLine{               \mbox{\hyperlink{parson_8c_a36f910ea5423925fd93de7c373dc0b32}{json\_object\_dotget\_string}}(commit, \textcolor{stringliteral}{"{}commit.author.date"{}}),}
\DoxyCodeLine{               \mbox{\hyperlink{parson_8c_a9e2d3e4d25595d394585cb11300bf53c}{json\_object\_get\_string}}(commit, \textcolor{stringliteral}{"{}sha"{}}),}
\DoxyCodeLine{               \mbox{\hyperlink{parson_8c_a36f910ea5423925fd93de7c373dc0b32}{json\_object\_dotget\_string}}(commit, \textcolor{stringliteral}{"{}commit.author.name"{}}));}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{comment}{/* cleanup code */}}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_ab2422931b5eea3c2401a86dea9c06b8c}{json\_value\_free}}(root\_value);}
\DoxyCodeLine{    system(cleanup\_command);}
\DoxyCodeLine{\}}

\end{DoxyCode}
 Calling {\ttfamily print\+\_\+commits\+\_\+info(\char`\"{}torvalds\char`\"{}, \char`\"{}linux\char`\"{});} prints\+: ~\newline
 
\begin{DoxyCode}{0}
\DoxyCodeLine{Date       SHA        Author}
\DoxyCodeLine{2012-\/10-\/15 dd8e8c4a2c David Rientjes}
\DoxyCodeLine{2012-\/10-\/15 3ce9e53e78 Michal Marek}
\DoxyCodeLine{2012-\/10-\/14 29bb4cc5e0 Randy Dunlap}
\DoxyCodeLine{2012-\/10-\/15 325adeb55e Ralf Baechle}
\DoxyCodeLine{2012-\/10-\/14 68687c842c Russell King}
\DoxyCodeLine{2012-\/10-\/14 ddffeb8c4d Linus Torvalds}
\DoxyCodeLine{...}

\end{DoxyCode}
\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md5}{}\doxysubsection{Persistence}\label{md_parson__r_e_a_d_m_e_autotoc_md5}
In this example I\textquotesingle{}m using parson to save user information to a file and then load it and validate later. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_a5116be375e8941f77e39b9202e09807a}{persistence\_example}}(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__value__t}{JSON\_Value}} *schema = \mbox{\hyperlink{parson_8c_a7e811c5276660cba5fa1758ff8dd86df}{json\_parse\_string}}(\textcolor{stringliteral}{"{}\{\(\backslash\)"{}name\(\backslash\)"{}:\(\backslash\)"{}\(\backslash\)"{}\}"{}});}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__value__t}{JSON\_Value}} *user\_data = \mbox{\hyperlink{parson_8c_ab46574724afc3f8bb047b73a9d477179}{json\_parse\_file}}(\textcolor{stringliteral}{"{}user\_data.json"{}});}
\DoxyCodeLine{    \textcolor{keywordtype}{char} buf[256];}
\DoxyCodeLine{    \textcolor{keyword}{const} \textcolor{keywordtype}{char} *name = NULL;}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (user\_data == NULL || \mbox{\hyperlink{parson_8c_a50dfef020cb9a9d82eaa2a540a5dd724}{json\_validate}}(schema, user\_data) != \mbox{\hyperlink{parson_8h_a3dceac6cdf3d02a782357f1e495bc585a6b579c45491843ff8dbc535fb17a0402}{JSONSuccess}}) \{}
\DoxyCodeLine{        puts(\textcolor{stringliteral}{"{}Enter your name:"{}});}
\DoxyCodeLine{        scanf(\textcolor{stringliteral}{"{}\%s"{}}, buf);}
\DoxyCodeLine{        user\_data = \mbox{\hyperlink{parson_8c_ad445f559e84d8dccaabcb048fe16e840}{json\_value\_init\_object}}();}
\DoxyCodeLine{        \mbox{\hyperlink{parson_8c_a4894ebaa8673c6dbc69519b6c1573c99}{json\_object\_set\_string}}(\mbox{\hyperlink{parson_8c_ad1a6df9a743eaa95a38637b6adebaa2f}{json\_object}}(user\_data), \textcolor{stringliteral}{"{}name"{}}, buf);}
\DoxyCodeLine{        \mbox{\hyperlink{parson_8c_a5501d255adc5040d420bcf7a257de999}{json\_serialize\_to\_file}}(user\_data, \textcolor{stringliteral}{"{}user\_data.json"{}});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    name = \mbox{\hyperlink{parson_8c_a9e2d3e4d25595d394585cb11300bf53c}{json\_object\_get\_string}}(\mbox{\hyperlink{parson_8c_ad1a6df9a743eaa95a38637b6adebaa2f}{json\_object}}(user\_data), \textcolor{stringliteral}{"{}name"{}});}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Hello, \%s."{}}, name);}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_ab2422931b5eea3c2401a86dea9c06b8c}{json\_value\_free}}(schema);}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_ab2422931b5eea3c2401a86dea9c06b8c}{json\_value\_free}}(user\_data);}
\DoxyCodeLine{    \textcolor{keywordflow}{return};}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md6}{}\doxysubsection{Serialization}\label{md_parson__r_e_a_d_m_e_autotoc_md6}
Creating JSON values is very simple thanks to the dot notation. Object hierarchy is automatically created when addressing specific fields. In the following example I create a simple JSON value containing basic information about a person. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_a527670e4b67b1b1232aaee12ef92e8ff}{serialization\_example}}(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__value__t}{JSON\_Value}} *root\_value = \mbox{\hyperlink{parson_8c_ad445f559e84d8dccaabcb048fe16e840}{json\_value\_init\_object}}();}
\DoxyCodeLine{    \mbox{\hyperlink{structjson__object__t}{JSON\_Object}} *root\_object = \mbox{\hyperlink{parson_8c_ad1965490be7fedbbc836f3c077cb0db2}{json\_value\_get\_object}}(root\_value);}
\DoxyCodeLine{    \textcolor{keywordtype}{char} *serialized\_string = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_a4894ebaa8673c6dbc69519b6c1573c99}{json\_object\_set\_string}}(root\_object, \textcolor{stringliteral}{"{}name"{}}, \textcolor{stringliteral}{"{}John Smith"{}});}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_a39e19ea718c221389fc991c22d39777d}{json\_object\_set\_number}}(root\_object, \textcolor{stringliteral}{"{}age"{}}, 25);}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_a0069c12155c176511ea091a6471cbe49}{json\_object\_dotset\_string}}(root\_object, \textcolor{stringliteral}{"{}address.city"{}}, \textcolor{stringliteral}{"{}Cupertino"{}});}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_a639e70952e2bffab866303ef528367a4}{json\_object\_dotset\_value}}(root\_object, \textcolor{stringliteral}{"{}contact.emails"{}}, \mbox{\hyperlink{parson_8c_a7e811c5276660cba5fa1758ff8dd86df}{json\_parse\_string}}(\textcolor{stringliteral}{"{}[\(\backslash\)"{}email@example.com\(\backslash\)"{},\(\backslash\)"{}email2@example.com\(\backslash\)"{}]"{}}));}
\DoxyCodeLine{    serialized\_string = \mbox{\hyperlink{parson_8c_adc914c37e3ab3be348336ba6910b009c}{json\_serialize\_to\_string\_pretty}}(root\_value);}
\DoxyCodeLine{    puts(serialized\_string);}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_a4b32b8273c00bdcdb3fb9b04062c8084}{json\_free\_serialized\_string}}(serialized\_string);}
\DoxyCodeLine{    \mbox{\hyperlink{parson_8c_ab2422931b5eea3c2401a86dea9c06b8c}{json\_value\_free}}(root\_value);}
\DoxyCodeLine{\}}

\end{DoxyCode}


Output\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{    "{}name"{}: "{}John Smith"{},}
\DoxyCodeLine{    "{}age"{}: 25,}
\DoxyCodeLine{    "{}address"{}: \{}
\DoxyCodeLine{        "{}city"{}: "{}Cupertino"{}}
\DoxyCodeLine{    \},}
\DoxyCodeLine{    "{}contact"{}: \{}
\DoxyCodeLine{        "{}emails"{}: [}
\DoxyCodeLine{            "{}email@example.com"{},}
\DoxyCodeLine{            "{}email2@example.com"{}}
\DoxyCodeLine{        ]}
\DoxyCodeLine{    \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md7}{}\doxysection{Contributing}\label{md_parson__r_e_a_d_m_e_autotoc_md7}
I will always merge {\itshape working} bug fixes. However, if you want to add something new to the API, please create an \char`\"{}issue\char`\"{} on github for this first so we can discuss if it should end up in the library before you start implementing it. Remember to follow parson\textquotesingle{}s code style and write appropriate tests.\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md8}{}\doxysection{My other projects}\label{md_parson__r_e_a_d_m_e_autotoc_md8}

\begin{DoxyItemize}
\item \href{https://github.com/kgabis/ape}{\texttt{ ape}} -\/ simple programming language implemented in C library
\item \href{https://github.com/kgabis/kgflags}{\texttt{ kgflags}} -\/ easy to use command-\/line flag parsing library ~\newline

\item \href{https://github.com/kgabis/agnes}{\texttt{ agnes}} -\/ header-\/only NES emulation library
\end{DoxyItemize}\hypertarget{md_parson__r_e_a_d_m_e_autotoc_md9}{}\doxysection{License}\label{md_parson__r_e_a_d_m_e_autotoc_md9}
\href{http://opensource.org/licenses/mit-license.php}{\texttt{ The MIT License (MIT)}} 